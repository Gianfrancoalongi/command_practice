#!/bin/bash

main()
{
	show_description
	dump_text_to_files
}

show_description()
{
cat <<EOF
    = Bits and Pieces =
    This exercise practices substring extraction and string manipulation.
    You are expected to complete the exercise, by using tr | cut | sed | grep.
EOF
}

dump_text_to_files()
{
    ROOT=$(mktemp --tmpdir=. -d)
    create_service_example_file
}

create_service_example_file()
{
    FILE=${ROOT}/service.xmpl
    DATA=( 'adam|2h-23m-21s|192.168.0.1|call,bridge' \
	'david|0h-2m-10s|192.169.0.2|call,bridge' \
	'john|1h-3m-1s|192.169.0.3|call' \
	'filip|2h-4m-45s|192.168.0.4|call,bridge,conference' \
	'susan|3h-34m-28s|192.165.0.3|call,music' \
	'ellie|5h-43m-49s|192.165.0.2|call,music,conference' \
	'michelle|1h-23m-21s|192.165.0.1|call' )	
    for data in ${DATA[*]}
    do
	echo ${data} | tr '|' ' ' | xargs printf "user:%s runtime:%s from:%s services:%s\n" >> ${FILE}
    done
}

main